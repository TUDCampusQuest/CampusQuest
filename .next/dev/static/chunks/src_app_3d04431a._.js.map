{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/chid/Documents/CampusQuest/src/app/data/locations.js"],"sourcesContent":["const locations = [\n  {\n    id: 'LIB01',\n    name: 'Test library Location',\n    lat: 53.40473,\n    lng: -6.37839,\n    description: 'Primary study and research space.',\n    accessibility: 'Step-free access, lifts available.',\n  },\n  {\n    id: 'CAF01',\n    name: 'C Block',\n    lat: 53.40542,\n    lng: -6.37875,\n    description: 'Main food and social area.',\n    accessibility: 'Wide entrances, accessible seating.',\n  },\n];\n\nexport default locations;\n"],"names":[],"mappings":";;;;AAAA,MAAM,YAAY;IAChB;QACE,IAAI;QACJ,MAAM;QACN,KAAK;QACL,KAAK,CAAC;QACN,aAAa;QACb,eAAe;IACjB;IACA;QACE,IAAI;QACJ,MAAM;QACN,KAAK;QACL,KAAK,CAAC;QACN,aAAa;QACb,eAAe;IACjB;CACD;uCAEc"}},
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///Users/chid/Documents/CampusQuest/src/app/components/MapView.jsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useRef } from 'react';\nimport { Box } from '@mui/material';\nimport locations from '../data/locations';\n\nconst GOOGLE_MAPS_SRC = (key) =>\n    `https://maps.googleapis.com/maps/api/js?key=${encodeURIComponent(\n        key\n    )}&v=weekly&loading=async`;\n\nfunction loadGoogleMapsScript(apiKey) {\n    return new Promise((resolve, reject) => {\n        // If already available (including importLibrary)\n        if (window.google?.maps?.importLibrary) return resolve();\n\n        const existing = document.querySelector('script[data-google-maps=\"true\"]');\n        if (existing) {\n            // If script exists but maps not ready yet, wait a bit\n            const start = Date.now();\n            const tick = () => {\n                if (window.google?.maps?.importLibrary) return resolve();\n                if (Date.now() - start > 5000)\n                    return reject(new Error('Google Maps loaded but importLibrary is missing.'));\n                requestAnimationFrame(tick);\n            };\n            tick();\n            return;\n        }\n\n        const script = document.createElement('script');\n        script.src = GOOGLE_MAPS_SRC(apiKey);\n        script.async = true;\n        script.defer = true;\n        script.dataset.googleMaps = 'true';\n\n        script.onload = () => {\n            const start = Date.now();\n            const tick = () => {\n                if (window.google?.maps?.importLibrary) return resolve();\n                if (Date.now() - start > 5000)\n                    return reject(new Error('Google Maps loaded but importLibrary is missing.'));\n                requestAnimationFrame(tick);\n            };\n            tick();\n        };\n\n        script.onerror = () => reject(new Error('Google Maps script failed to load'));\n        document.head.appendChild(script);\n    });\n}\n\nexport default function MapView({ onSelectLocation }) {\n    const mapRef = useRef(null);\n    const mapInstanceRef = useRef(null);\n    const markersRef = useRef([]);\n\n    useEffect(() => {\n        let cancelled = false;\n\n        async function init() {\n            const apiKey = process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY;\n\n            if (!apiKey) {\n                console.error(\n                    'Missing NEXT_PUBLIC_GOOGLE_MAPS_API_KEY. Check .env.local and restart `npm run dev`.'\n                );\n                return;\n            }\n\n            try {\n                await loadGoogleMapsScript(apiKey);\n                if (cancelled || !mapRef.current) return;\n\n                // Modern API: import libraries\n                const { Map } = await window.google.maps.importLibrary('maps');\n                const { Marker } = await window.google.maps.importLibrary('marker');\n\n                // Create map once\n                if (!mapInstanceRef.current) {\n                    mapInstanceRef.current = new Map(mapRef.current, {\n                        center: { lat: 53.405292, lng: -6.378240 },\n                        zoom: 16,\n                        mapTypeControl: false,\n                        fullscreenControl: false,\n                    });\n                }\n\n                const map = mapInstanceRef.current;\n\n                // Clear old markers\n                markersRef.current.forEach((m) => {\n                    // AdvancedMarkerElement uses map = null\n                    if ('map' in m) m.map = null;\n                    // Classic marker uses setMap\n                    if (typeof m.setMap === 'function') m.setMap(null);\n                });\n                markersRef.current = [];\n\n                // Add markers\n                locations.forEach((location) => {\n                    // Marker here will be AdvancedMarkerElement in newer API\n                    const marker = new Marker({\n                        position: { lat: location.lat, lng: location.lng },\n                        map,\n                        title: location.name,\n                    });\n\n                    // AdvancedMarkerElement uses addListener? Some versions use event system.\n                    // This works for classic markers; for AdvancedMarkerElement, use click listener if present.\n                    if (typeof marker.addListener === 'function') {\n                        marker.addListener('click', () => onSelectLocation?.(location));\n                    } else if (marker.element) {\n                        marker.element.addEventListener('click', () => onSelectLocation?.(location));\n                    }\n\n                    markersRef.current.push(marker);\n                });\n            } catch (err) {\n                console.error(err);\n            }\n        }\n\n        init();\n        return () => {\n            cancelled = true;\n        };\n    }, [onSelectLocation]);\n\n    return (\n        <Box\n            ref={mapRef}\n            sx={{\n                position: 'absolute',\n                inset: 0,\n                width: '100%',\n                height: '100%',\n            }}\n        />\n    );\n}"],"names":[],"mappings":"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"}}]
}